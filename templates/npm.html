<!-- templates/npm.html -->
{% extends "base.html" %} {% block title %}Nginx Proxy Manager{% endblock %} {%
block content %}
<div class="hexagons" id="hexagon-container"></div>
<div class="npm-container" style="display: flex; min-height: 100vh">
    <!-- Sidebar Navigation -->
    <div
        class="npm-sidebar"
        id="npmSidebar"
        style="width: 250px; flex-shrink: 0"
    >
        <div class="sidebar-group">
            <div class="sidebar-header">
                <span class="sidebar-icon">üåê</span>
                <span>Hosts</span>
                <span class="arrow">‚ñº</span>
            </div>
            <div class="sidebar-items" id="hosts">
                <a href="#proxy" class="sidebar-item active">Proxy Hosts</a>
                <a href="#redirection" class="sidebar-item"
                    >Redirection Hosts</a
                >
                <a href="#stream" class="sidebar-item">Stream Hosts</a>
            </div>
        </div>

        <div class="sidebar-group">
            <div class="sidebar-header">
                <span class="sidebar-icon">üîí</span>
                <span>Security</span>
                <span class="arrow">‚ñº</span>
            </div>
            <div class="sidebar-items" id="security">
                <a href="#access" class="sidebar-item">Access Lists</a>
                <a href="#certificates" class="sidebar-item">Certificates</a>
            </div>
        </div>

        <div class="sidebar-group">
            <div class="sidebar-header">
                <span class="sidebar-icon">‚öôÔ∏è</span>
                <span>System</span>
                <span class="arrow">‚ñº</span>
            </div>
            <div class="sidebar-items" id="system">
                <a href="#audit" class="sidebar-item">Audit Log</a>
                <a href="#settings" class="sidebar-item">Settings</a>
            </div>
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="npm-content" style="flex: 1; padding: 20px">
        <!-- Action Bar -->
        <div
            class="action-bar"
            style="
                display: flex;
                justify-content: space-between;
                align-items: center;
            "
        >
            <button class="btn btn-primary" id="addNewBtn">Add New</button>
            <div class="search-bar">
                <input type="text" id="searchInput" placeholder="Search..." />
            </div>
        </div>

        <!-- Dynamic Content Views -->
        <div id="proxyView" class="content-view active">
            <div class="card-grid" id="proxyHostsGrid">
                <!-- Host cards will be dynamically injected here.
             Example placeholder structure (actual data is injected via JavaScript):

             <div class="host-card glass-card">
               <div class="card-header">
                 <h3>{{ host.domain_placeholder }}</h3>
                 <div class="status-indicator active"></div>
               </div>
               <div class="card-content">
                 <p>Forward: {{ host.forward_placeholder }}</p>
                 <p>SSL: {{ host.ssl_status_placeholder }}</p>
                 <p>Cache: {{ host.cache_status_placeholder }}</p>
               </div>
               <div class="card-actions">
                 <button class="btn btn-primary" onclick="npmManager.editHost({{ host.id }})">Edit</button>
                 <button class="btn btn-secondary" onclick="npmManager.deleteHost({{ host.id }})">Delete</button>
                 <button class="btn btn-secondary" onclick="host.enabled ? npmManager.disableProxyHost({{ host.id }}) : npmManager.enableProxyHost({{ host.id }})">Disable</button>
               </div>
             </div>
        -->
            </div>
        </div>

        <div id="redirectionView" class="content-view" style="display: none">
            <div class="card-grid" id="redirectionHostsGrid">
                <!-- Dynamic redirection host cards -->
            </div>
        </div>

        <div id="streamView" class="content-view" style="display: none">
            <div class="card-grid" id="streamHostsGrid">
                <!-- Dynamic stream host cards -->
            </div>
        </div>

        <div id="accessView" class="content-view" style="display: none">
            <div class="card-grid" id="accessListsGrid">
                <!-- Dynamic access list cards -->
            </div>
        </div>

        <div id="certificatesView" class="content-view" style="display: none">
            <div class="certificates-header">
                <div class="cert-stats">
                    <div class="stat-card">
                        <h3>Valid Certificates</h3>
                        <span id="validCertsCount">0</span>
                    </div>
                    <div class="stat-card warning">
                        <h3>Expiring Soon</h3>
                        <span id="expiringSoonCount">0</span>
                    </div>
                    <div class="stat-card danger">
                        <h3>Expired</h3>
                        <span id="expiredCount">0</span>
                    </div>
                </div>
            </div>
            <div class="card-grid" id="certificatesGrid">
                <!-- Dynamic certificate cards -->
            </div>
        </div>

        <div id="auditView" class="content-view" style="display: none">
            <div class="audit-log-container">
                <table id="auditLogTable" class="data-table">
                    <thead>
                        <tr>
                            <th>Timestamp</th>
                            <th>User</th>
                            <th>Action</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dynamic audit log entries -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="settingsView" class="content-view" style="display: none">
            <div class="settings-grid">
                <div class="settings-card">
                    <h3>Default Settings</h3>
                    <form id="defaultSettingsForm">
                        <div class="form-group">
                            <label for="defaultSite">Default Site</label>
                            <input
                                type="text"
                                id="defaultSite"
                                name="defaultSite"
                                value="placeholder.com"
                                required
                            />
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                Save Settings
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Mode Toggle Button -->
<button class="mode-toggle" id="modeToggle" title="Toggle light/dark mode">
    üí°
</button>

<!-- Modals -->
<div id="addHostModal" class="modal">
    <div class="modal-content">
        <h2>Add New Host</h2>
        <form id="addHostForm">
            <!-- Form fields will be dynamically populated -->
        </form>
    </div>
</div>

<div id="certificateModal" class="modal">
    <div class="modal-content">
        <h2>Add Certificate</h2>
        <div class="cert-tabs">
            <button class="btn btn-secondary cert-tab active" data-tab="upload">
                Upload Certificate
            </button>
            <button class="btn btn-secondary cert-tab" data-tab="letsencrypt">
                Let's Encrypt
            </button>
        </div>
        <div class="cert-content">
            <form id="uploadCertForm" class="cert-form active">
                <div class="form-group">
                    <label for="certFile">Certificate File</label>
                    <input type="file" id="certFile" name="certFile" required />
                </div>
                <div class="form-group">
                    <label for="keyFile">Key File</label>
                    <input type="file" id="keyFile" name="keyFile" required />
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        Upload
                    </button>
                    <button
                        type="button"
                        class="btn btn-secondary"
                        onclick="closeModals()"
                    >
                        Cancel
                    </button>
                </div>
            </form>
            <form id="letsencryptForm" class="cert-form">
                <div class="form-group">
                    <label for="domainNames">Domain Names</label>
                    <input
                        type="text"
                        id="domainNames"
                        name="domainNames"
                        placeholder="e.g. example.com, www.example.com"
                        required
                    />
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        Request Certificate
                    </button>
                    <button
                        type="button"
                        class="btn btn-secondary"
                        onclick="closeModals()"
                    >
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %} {% block scripts %}
<script src="{{ url_for('static', filename='animations.js') }}"></script>
<script src="{{ url_for('static', filename='theme.js') }}"></script>
<script
    type="module"
    src="{{ url_for('static', filename='npm/npm.js') }}"
></script>
<script>
    window.npmDomain = "{{ npm_domain }}";
</script>
{% endblock %}
